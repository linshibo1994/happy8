# 需求文档 - 数字对频率分析功能

## 介绍

本功能旨在为快乐8预测系统添加数字对频率分析能力。用户可以指定期号范围和统计期数，系统将分析在指定期数内同时出现的两位数组合，并按出现频率进行排序。这将帮助用户识别历史数据中的数字组合模式，为预测提供参考依据。

## 需求

### 需求 1 - 基础数字对频率统计

**用户故事：** 作为快乐8玩家，我希望能够统计指定期数内两位数组合的出现频率，以便分析数字组合的历史规律。

#### 验收标准

1. 当用户输入起始期号和统计期数时，系统应当分析指定范围内的所有期次数据
2. 当系统处理每期开奖数据时，系统应当计算所有可能的两位数组合（从20个号码中选择2个的组合）
3. 当系统完成统计时，系统应当返回所有两位数组合及其出现次数
4. 当存在多个组合时，系统应当按出现频率从高到低排序
5. 如果指定的期号范围超出可用数据范围，系统应当提示用户并使用可用的数据范围

### 需求 2 - 基于指定期号的历史统计

**用户故事：** 作为用户，我希望能够输入指定期号和统计期数，系统从该期号开始向前统计过去N期的数字对出现频率。

#### 验收标准

1. 当用户输入期号（如2025091）和统计期数（如20）时，系统应当从该期号开始向前统计指定期数
2. 当系统计算统计范围时，系统应当确定实际的期号范围（如2025091期的过去20期为2025072-2025091）
3. 当用户输入的期号格式正确时，系统应当验证该期号是否存在于历史数据中
4. 当统计期数超过该期号之前的可用数据时，系统应当使用所有可用的历史数据并提示实际统计期数
5. 如果指定期号不存在或格式错误，系统应当提供清晰的错误提示

### 需求 3 - 灵活的查询参数

**用户故事：** 作为用户，我希望能够灵活设置查询参数，以便进行不同维度的分析。

#### 验收标准

1. 当用户输入统计期数时，系统应当支持1-100期的范围设置
2. 当用户未指定起始期号时，系统应当默认从最新期号开始向前统计
3. 当用户输入期号时，系统应当支持标准的期号格式（如2025091、2024001等）
4. 当用户输入的参数组合有效时，系统应当显示实际的统计范围供用户确认
5. 如果输入参数无效，系统应当提供清晰的错误提示和正确的输入格式说明

### 需求 4 - 结果展示和格式化

**用户故事：** 作为用户，我希望看到清晰、易读的分析结果，以便快速理解数字组合的频率分布。

#### 验收标准

1. 当系统返回结果时，系统应当显示每个数字对及其出现次数
2. 当显示数字对时，系统应当按统一格式显示（如"05-15"或"(5, 15)"）
3. 当显示结果时，系统应当包含统计摘要信息（总期数、分析的数字对总数、最高频率等）
4. 当结果数量较多时，系统应当支持分页显示或限制显示前N个结果
5. 如果某些数字对出现频率相同，系统应当按数字大小进行二级排序

### 需求 5 - 数据导出功能

**用户故事：** 作为用户，我希望能够导出分析结果，以便进行进一步的分析或保存记录。

#### 验收标准

1. 当用户请求导出时，系统应当支持CSV格式导出
2. 当导出数据时，系统应当包含完整的统计信息（数字对、出现次数、出现频率百分比）
3. 当生成导出文件时，系统应当包含查询参数信息作为文件头部说明
4. 当导出完成时，系统应当提供下载链接或保存路径
5. 如果导出失败，系统应当提供错误信息和重试选项

### 需求 6 - 性能和用户体验

**用户故事：** 作为用户，我希望系统能够快速响应我的查询，并提供良好的使用体验。

#### 验收标准

1. 当处理50期以内的数据时，系统应当在3秒内返回结果
2. 当处理大量数据时，系统应当显示进度指示器
3. 当系统正在计算时，系统应当防止用户重复提交相同请求
4. 当计算完成时，系统应当提供结果缓存以加快相同查询的响应速度
5. 如果计算时间超过10秒，系统应当提供取消操作的选项

## 使用示例

### 示例 1：指定期号的历史统计
- **输入：** 期号：2025091，统计期数：20
- **输出：**
```
数字对频率分析结果
指定期号：2025091期
统计范围：2025072-2025091期 (过去20期)
分析的数字对总数：190种组合

排序结果：
1. (05, 15) - 出现 12 次 (60.0%)
2. (04, 18) - 出现 11 次 (55.0%)
3. (07, 12) - 出现 10 次 (50.0%)
4. (02, 19) - 出现 9 次 (45.0%)
5. (01, 20) - 出现 8 次 (40.0%)
...
```

### 示例 2：默认查询（最近20期）
- **输入：** 统计期数：20
- **输出：**
```
数字对频率分析结果
查询范围：最近20期 (2024081-2024100)
分析的数字对总数：190种组合

排序结果：
1. (03, 16) - 出现 12 次 (60.0%)
2. (08, 14) - 出现 11 次 (55.0%)
3. (05, 17) - 出现 10 次 (50.0%)
...
```

### 示例 3：数据不足的情况
- **输入：** 期号：2024005，统计期数：20
- **输出：**
```
提示：请求统计2024005期的过去20期，但该期号之前只有4期数据可用
实际分析范围：2024001-2024005期 (共5期)

数字对频率分析结果：
1. (09, 13) - 出现 3 次 (60.0%)
2. (06, 11) - 出现 2 次 (40.0%)
...
```

### 示例 4：输入期号，统计过去期数
- **输入：** 期号：2025091，统计期数：20
- **说明：** 统计2025091期过去的20期（即2025072-2025091期）内同时出现的两位数组合
- **输出：**
```
数字对频率分析结果
指定期号：2025091期
统计范围：2025072-2025091期 (过去20期)

两位数组合出现频率排序：
1. (05, 15) - 出现 12 次 - 概率 60.0%
2. (04, 18) - 出现 11 次 - 概率 55.0%  
3. (07, 12) - 出现 10 次 - 概率 50.0%
4. (02, 19) - 出现 9 次 - 概率 45.0%
5. (01, 20) - 出现 8 次 - 概率 40.0%
...
```